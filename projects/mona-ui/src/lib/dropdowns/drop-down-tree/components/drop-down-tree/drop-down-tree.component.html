<div class="mona-dropdown-tree" (click)="open()" #dropdownWrapper>
    <div class="mona-dropdown-value">
        <span>{{text()}}</span>
    </div>
    <button monaButton [tabindex]="-1" class="mona-input-button">
        <fa-icon [icon]="dropdownIcon"></fa-icon>
    </button>
</div>

<ng-template #popupTemplate>
    <div class="mona-dropdown-tree-popup-wrapper">
        @if (headerTemplate) {
            <div class="mona-dropdown-tree-header">
                <ng-container [ngTemplateOutlet]="headerTemplate"></ng-container>
            </div>
        }
        @if (treeService.filterableOptions().enabled) {
            <div class="mona-dropdown-tree-filter">
                <mona-filter-input [filter]="treeService.filterText()"
                                   [debounce]="treeService.filterableOptions().debounce"
                                   [placeholder]="treeService.filterPlaceholder()"
                                   (filterChange)="onFilterChange($event)"></mona-filter-input>
            </div>
        }
        <div class="mona-dropdown-tree-container">
            @if (treeService.nodeSet().length === 0) {
                @if (!noDataTemplate) {
                    <mona-placeholder [text]="'No data'"></mona-placeholder>
                } @else {
                    <ng-container [ngTemplateOutlet]="noDataTemplate"></ng-container>
                }
            } @else {
                <mona-tree>
                    @if (nodeTemplate) {
                        <ng-template monaTreeNodeTemplate let-dataItem>
                            <ng-container [ngTemplateOutlet]="nodeTemplate"
                                          [ngTemplateOutletContext]="{$implicit: dataItem}"></ng-container>
                        </ng-template>
                    }
                </mona-tree>
            }
        </div>
        @if (footerTemplate) {
            <div class="mona-dropdown-tree-footer">
                <ng-container [ngTemplateOutlet]="footerTemplate"></ng-container>
            </div>
        }
    </div>
</ng-template>