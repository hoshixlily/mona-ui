<div class="mona-dropdown mona-dropdown-list mona-input-selector" [attr.tabindex]="disabled ? -1 : 0"
     [ngClass]="{'mona-disabled': disabled}"
     (click)="open()"
     #dropdownWrapper>
    <div class="mona-input-selector-value">
        <ng-container *ngIf="!valueTemplate">
            <span>{{selectedListItems[0]?.text ?? value}}</span>
        </ng-container>
        <ng-container *ngIf="valueTemplate">
            <ng-container [ngTemplateOutlet]="valueTemplate"
                          [ngTemplateOutletContext]="{$implicit: selectedListItems[0]?.data ?? value, listItem: selectedListItems[0]}"></ng-container>
        </ng-container>
    </div>
    <div class="mona-input-selector-icon">
        <fa-icon [icon]="dropdownIcon"></fa-icon>
    </div>
</div>

<ng-template #dropdownPopupTemplate>
    <div *ngIf="filterable">
        <mona-text-box class="filter-box" [ngModel]="filterText" (ngModelChange)="filterChange$.next($event)"
                       (keydown)="filterKeydown$.next($event)">
            <ng-template monaTextBoxPrefixTemplate>
                <fa-icon [icon]="filterIcon"></fa-icon>
            </ng-template>
        </mona-text-box>
    </div>
    <div>
        <mona-list [data]="viewData" [itemDisabler]="itemDisabler" [highlightable]="true" [highlightedItem]="selectedListItems[0]"
                   [value]="selectedListItems" (valueChange)="onSelectedListItemsChange($event)" #listComponent>
            <ng-container *ngIf="itemTemplate">
                <ng-template monaListItemTemplate let-dataItem let-listItem="listItem">
                    <ng-container [ngTemplateOutlet]="itemTemplate ?? null"
                                  [ngTemplateOutletContext]="{$implicit: dataItem, listItem}"></ng-container>
                </ng-template>
            </ng-container>
            <ng-container *ngIf="groupTemplate">
                <ng-template monaListGroupTemplate let-dataItem let-listItem="listItem">
                    <ng-container [ngTemplateOutlet]="groupTemplate ?? null"
                                  [ngTemplateOutletContext]="{$implicit: dataItem, listItem}"></ng-container>
                </ng-template>
            </ng-container>
        </mona-list>
    </div>
</ng-template>
