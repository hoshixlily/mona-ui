import { Component, ContentChild, EventEmitter, Input, Output, TemplateRef } from "@angular/core";
import { AbstractDropDownListComponent } from "../../../../components/abstract-drop-down-list/abstract-drop-down-list.component";
import { PopupListService } from "../../../../services/popup-list.service";
import { DropDownListItemTemplateDirective } from "../../directives/drop-down-list-item-template.directive";
import { DropDownListValueTemplateDirective } from "../../directives/drop-down-list-value-template.directive";
import { DropDownListGroupTemplateDirective } from "../../directives/drop-down-list-group-template.directive";
import * as i0 from "@angular/core";
import * as i1 from "../../../../services/popup-list.service";
import * as i2 from "../../../../../popup/services/popup.service";
import * as i3 from "@angular/common";
import * as i4 from "../../../../components/popup-list/popup-list.component";
import * as i5 from "@fortawesome/angular-fontawesome";
import * as i6 from "../../../../directives/list-item-template.directive";
import * as i7 from "../../../../directives/list-group-template.directive";
import * as i8 from "../../../../../buttons/modules/button/directives/button.directive";
export class DropDownListComponent extends AbstractDropDownListComponent {
    constructor(elementRef, popupListService, popupService) {
        super(elementRef, popupListService, popupService);
        this.elementRef = elementRef;
        this.popupListService = popupListService;
        this.popupService = popupService;
        this.openOnEnter = true;
        this.selectionMode = "single";
        this.filterable = false;
        this.valueChange = new EventEmitter();
    }
    clearValue(event) {
        event.stopImmediatePropagation();
        this.updateValue(undefined);
    }
    ngOnInit() {
        super.ngOnInit();
    }
    onPopupListValueChange(event) {
        if (!event.value || event.value.length === 0) {
            this.updateValue(undefined);
            return;
        }
        if (this.value && event.value[0].dataEquals(this.value)) {
            if (event.via === "selection") {
                this.close();
            }
            return;
        }
        if (event.via === "selection") {
            this.close();
        }
        this.updateValue(event.value[0]);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.0.0", ngImport: i0, type: DropDownListComponent, deps: [{ token: i0.ElementRef }, { token: i1.PopupListService }, { token: i2.PopupService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.0.0", type: DropDownListComponent, selector: "mona-drop-down-list", inputs: { filterable: "filterable", value: "value" }, outputs: { valueChange: "valueChange" }, providers: [PopupListService], queries: [{ propertyName: "groupTemplate", first: true, predicate: DropDownListGroupTemplateDirective, descendants: true, read: TemplateRef }, { propertyName: "itemTemplate", first: true, predicate: DropDownListItemTemplateDirective, descendants: true, read: TemplateRef }, { propertyName: "valueTemplate", first: true, predicate: DropDownListValueTemplateDirective, descendants: true, read: TemplateRef }], usesInheritance: true, ngImport: i0, template: "<div class=\"mona-dropdown mona-dropdown-list mona-input-selector\" [ngClass]=\"{'mona-disabled': disabled}\" [attr.tabindex]=\"disabled ? -1 : 0\" (click)=\"open()\" #dropdownWrapper>\n    <div class=\"mona-input-selector-value\">\n        <ng-container *ngIf=\"!valueTemplate\">\n            <span *ngIf=\"valuePopupListItem\">{{valuePopupListItem?.text}}</span>\n            <span *ngIf=\"!valuePopupListItem\">{{placeholder}}</span>\n        </ng-container>\n        <ng-container *ngIf=\"valueTemplate\">\n            <ng-container [ngTemplateOutlet]=\"valueTemplate\" [ngTemplateOutletContext]=\"{$implicit: valuePopupListItem?.data, listItem: valuePopupListItem}\"></ng-container>\n        </ng-container>\n    </div>\n    <div class=\"mona-input-selector-icon\" *ngIf=\"showClearButton && valuePopupListItem\">\n        <button monaButton [flat]=\"true\" (click)=\"clearValue($event)\" class=\"mona-dropdown-clear-icon\">\n            <fa-icon [icon]=\"clearIcon\"></fa-icon>\n        </button>\n    </div>\n    <div class=\"mona-input-selector-icon\">\n        <fa-icon [icon]=\"dropdownIcon\"></fa-icon>\n    </div>\n</div>\n\n<ng-template #popupTemplate>\n    <div *ngIf=\"!!popupRef\">\n        <mona-popup-list [textField]=\"textField\" [valueField]=\"valueField\" [groupField]=\"groupField\" [value]=\"value ? [value] : []\"\n                         [filterable]=\"filterable\"\n                         (valueChange)=\"onPopupListValueChange($event)\">\n            <ng-container *ngIf=\"itemTemplate\">\n                <ng-template monaListItemTemplate let-dataItem let-listItem=\"listItem\">\n                    <ng-container [ngTemplateOutlet]=\"itemTemplate ?? null\" [ngTemplateOutletContext]=\"{$implicit: dataItem, listItem}\"></ng-container>\n                </ng-template>\n            </ng-container>\n            <ng-container *ngIf=\"groupTemplate\">\n                <ng-template monaListGroupTemplate let-dataItem let-listItem=\"listItem\">\n                    <ng-container [ngTemplateOutlet]=\"groupTemplate ?? null\" [ngTemplateOutletContext]=\"{$implicit: dataItem, listItem}\"></ng-container>\n                </ng-template>\n            </ng-container>\n        </mona-popup-list>\n    </div>\n</ng-template>\n", styles: [""], dependencies: [{ kind: "directive", type: i3.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i3.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: i4.PopupListComponent, selector: "mona-popup-list", inputs: ["filterable", "groupField", "highlightedValues", "navigable", "selectionMode", "textField", "value", "valueField"], outputs: ["valueChange"] }, { kind: "component", type: i5.FaIconComponent, selector: "fa-icon", inputs: ["icon", "title", "spin", "pulse", "mask", "styles", "flip", "size", "pull", "border", "inverse", "symbol", "rotate", "fixedWidth", "classes", "transform", "a11yRole"] }, { kind: "directive", type: i6.ListItemTemplateDirective, selector: "ng-template[monaListItemTemplate]" }, { kind: "directive", type: i7.ListGroupTemplateDirective, selector: "ng-template[monaListGroupTemplate]" }, { kind: "directive", type: i8.ButtonDirective, selector: "[monaButton]", inputs: ["disabled", "flat", "primary", "selected", "toggleable"], outputs: ["selectedChange"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.0.0", ngImport: i0, type: DropDownListComponent, decorators: [{
            type: Component,
            args: [{ selector: "mona-drop-down-list", providers: [PopupListService], template: "<div class=\"mona-dropdown mona-dropdown-list mona-input-selector\" [ngClass]=\"{'mona-disabled': disabled}\" [attr.tabindex]=\"disabled ? -1 : 0\" (click)=\"open()\" #dropdownWrapper>\n    <div class=\"mona-input-selector-value\">\n        <ng-container *ngIf=\"!valueTemplate\">\n            <span *ngIf=\"valuePopupListItem\">{{valuePopupListItem?.text}}</span>\n            <span *ngIf=\"!valuePopupListItem\">{{placeholder}}</span>\n        </ng-container>\n        <ng-container *ngIf=\"valueTemplate\">\n            <ng-container [ngTemplateOutlet]=\"valueTemplate\" [ngTemplateOutletContext]=\"{$implicit: valuePopupListItem?.data, listItem: valuePopupListItem}\"></ng-container>\n        </ng-container>\n    </div>\n    <div class=\"mona-input-selector-icon\" *ngIf=\"showClearButton && valuePopupListItem\">\n        <button monaButton [flat]=\"true\" (click)=\"clearValue($event)\" class=\"mona-dropdown-clear-icon\">\n            <fa-icon [icon]=\"clearIcon\"></fa-icon>\n        </button>\n    </div>\n    <div class=\"mona-input-selector-icon\">\n        <fa-icon [icon]=\"dropdownIcon\"></fa-icon>\n    </div>\n</div>\n\n<ng-template #popupTemplate>\n    <div *ngIf=\"!!popupRef\">\n        <mona-popup-list [textField]=\"textField\" [valueField]=\"valueField\" [groupField]=\"groupField\" [value]=\"value ? [value] : []\"\n                         [filterable]=\"filterable\"\n                         (valueChange)=\"onPopupListValueChange($event)\">\n            <ng-container *ngIf=\"itemTemplate\">\n                <ng-template monaListItemTemplate let-dataItem let-listItem=\"listItem\">\n                    <ng-container [ngTemplateOutlet]=\"itemTemplate ?? null\" [ngTemplateOutletContext]=\"{$implicit: dataItem, listItem}\"></ng-container>\n                </ng-template>\n            </ng-container>\n            <ng-container *ngIf=\"groupTemplate\">\n                <ng-template monaListGroupTemplate let-dataItem let-listItem=\"listItem\">\n                    <ng-container [ngTemplateOutlet]=\"groupTemplate ?? null\" [ngTemplateOutletContext]=\"{$implicit: dataItem, listItem}\"></ng-container>\n                </ng-template>\n            </ng-container>\n        </mona-popup-list>\n    </div>\n</ng-template>\n" }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i1.PopupListService }, { type: i2.PopupService }]; }, propDecorators: { filterable: [{
                type: Input
            }], groupTemplate: [{
                type: ContentChild,
                args: [DropDownListGroupTemplateDirective, { read: TemplateRef }]
            }], itemTemplate: [{
                type: ContentChild,
                args: [DropDownListItemTemplateDirective, { read: TemplateRef }]
            }], value: [{
                type: Input
            }], valueChange: [{
                type: Output
            }], valueTemplate: [{
                type: ContentChild,
                args: [DropDownListValueTemplateDirective, { read: TemplateRef }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHJvcC1kb3duLWxpc3QuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbW9uYS11aS9zcmMvbGliL2Ryb3Bkb3ducy9tb2R1bGVzL2Ryb3AtZG93bi1saXN0L2NvbXBvbmVudHMvZHJvcC1kb3duLWxpc3QvZHJvcC1kb3duLWxpc3QuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbW9uYS11aS9zcmMvbGliL2Ryb3Bkb3ducy9tb2R1bGVzL2Ryb3AtZG93bi1saXN0L2NvbXBvbmVudHMvZHJvcC1kb3duLWxpc3QvZHJvcC1kb3duLWxpc3QuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQWMsWUFBWSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3RILE9BQU8sRUFBRSw2QkFBNkIsRUFBRSxNQUFNLGtGQUFrRixDQUFDO0FBRWpJLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBRzNFLE9BQU8sRUFBRSxpQ0FBaUMsRUFBRSxNQUFNLHlEQUF5RCxDQUFDO0FBQzVHLE9BQU8sRUFBRSxrQ0FBa0MsRUFBRSxNQUFNLDBEQUEwRCxDQUFDO0FBRTlHLE9BQU8sRUFBRSxrQ0FBa0MsRUFBRSxNQUFNLDBEQUEwRCxDQUFDOzs7Ozs7Ozs7O0FBUTlHLE1BQU0sT0FBTyxxQkFBc0IsU0FBUSw2QkFBNkI7SUF1QnBFLFlBQ2dDLFVBQW1DLEVBQ25DLGdCQUFrQyxFQUNsQyxZQUEwQjtRQUV0RCxLQUFLLENBQUMsVUFBVSxFQUFFLGdCQUFnQixFQUFFLFlBQVksQ0FBQyxDQUFDO1FBSnRCLGVBQVUsR0FBVixVQUFVLENBQXlCO1FBQ25DLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBa0I7UUFDbEMsaUJBQVksR0FBWixZQUFZLENBQWM7UUF6QnZDLGdCQUFXLEdBQVksSUFBSSxDQUFDO1FBQ3JDLGtCQUFhLEdBQWtCLFFBQVEsQ0FBQztRQUkzQyxlQUFVLEdBQVksS0FBSyxDQUFDO1FBWW5CLGdCQUFXLEdBQThCLElBQUksWUFBWSxFQUFPLENBQUM7SUFXakYsQ0FBQztJQUVNLFVBQVUsQ0FBQyxLQUFpQjtRQUMvQixLQUFLLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztRQUNqQyxJQUFJLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFZSxRQUFRO1FBQ3BCLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNyQixDQUFDO0lBRU0sc0JBQXNCLENBQUMsS0FBZ0M7UUFDMUQsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQzFDLElBQUksQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDNUIsT0FBTztTQUNWO1FBQ0QsSUFBSSxJQUFJLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUNyRCxJQUFJLEtBQUssQ0FBQyxHQUFHLEtBQUssV0FBVyxFQUFFO2dCQUMzQixJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7YUFDaEI7WUFDRCxPQUFPO1NBQ1Y7UUFDRCxJQUFJLEtBQUssQ0FBQyxHQUFHLEtBQUssV0FBVyxFQUFFO1lBQzNCLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztTQUNoQjtRQUNELElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3JDLENBQUM7OEdBdkRRLHFCQUFxQjtrR0FBckIscUJBQXFCLDZJQUZuQixDQUFDLGdCQUFnQixDQUFDLHFFQVVmLGtDQUFrQywyQkFBVSxXQUFXLDREQUd2RCxpQ0FBaUMsMkJBQVUsV0FBVyw2REFTdEQsa0NBQWtDLDJCQUFVLFdBQVcsb0RDckN6RSwyc0VBc0NBOzsyRkRyQmEscUJBQXFCO2tCQU5qQyxTQUFTOytCQUNJLHFCQUFxQixhQUdwQixDQUFDLGdCQUFnQixDQUFDOzJKQVF0QixVQUFVO3NCQURoQixLQUFLO2dCQUlDLGFBQWE7c0JBRG5CLFlBQVk7dUJBQUMsa0NBQWtDLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFO2dCQUloRSxZQUFZO3NCQURsQixZQUFZO3VCQUFDLGlDQUFpQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRTtnQkFJdEQsS0FBSztzQkFEcEIsS0FBSztnQkFJVSxXQUFXO3NCQUQxQixNQUFNO2dCQUlBLGFBQWE7c0JBRG5CLFlBQVk7dUJBQUMsa0NBQWtDLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBDb250ZW50Q2hpbGQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0LCBUZW1wbGF0ZVJlZiB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBBYnN0cmFjdERyb3BEb3duTGlzdENvbXBvbmVudCB9IGZyb20gXCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL2Fic3RyYWN0LWRyb3AtZG93bi1saXN0L2Fic3RyYWN0LWRyb3AtZG93bi1saXN0LmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgUG9wdXBTZXJ2aWNlIH0gZnJvbSBcIi4uLy4uLy4uLy4uLy4uL3BvcHVwL3NlcnZpY2VzL3BvcHVwLnNlcnZpY2VcIjtcbmltcG9ydCB7IFBvcHVwTGlzdFNlcnZpY2UgfSBmcm9tIFwiLi4vLi4vLi4vLi4vc2VydmljZXMvcG9wdXAtbGlzdC5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBTZWxlY3Rpb25Nb2RlIH0gZnJvbSBcIi4uLy4uLy4uLy4uLy4uL21vZGVscy9TZWxlY3Rpb25Nb2RlXCI7XG5pbXBvcnQgeyBQb3B1cExpc3RWYWx1ZUNoYW5nZUV2ZW50IH0gZnJvbSBcIi4uLy4uLy4uLy4uL2RhdGEvUG9wdXBMaXN0VmFsdWVDaGFuZ2VFdmVudFwiO1xuaW1wb3J0IHsgRHJvcERvd25MaXN0SXRlbVRlbXBsYXRlRGlyZWN0aXZlIH0gZnJvbSBcIi4uLy4uL2RpcmVjdGl2ZXMvZHJvcC1kb3duLWxpc3QtaXRlbS10ZW1wbGF0ZS5kaXJlY3RpdmVcIjtcbmltcG9ydCB7IERyb3BEb3duTGlzdFZhbHVlVGVtcGxhdGVEaXJlY3RpdmUgfSBmcm9tIFwiLi4vLi4vZGlyZWN0aXZlcy9kcm9wLWRvd24tbGlzdC12YWx1ZS10ZW1wbGF0ZS5kaXJlY3RpdmVcIjtcbmltcG9ydCB7IFBvcHVwTGlzdEl0ZW0gfSBmcm9tIFwiLi4vLi4vLi4vLi4vZGF0YS9Qb3B1cExpc3RJdGVtXCI7XG5pbXBvcnQgeyBEcm9wRG93bkxpc3RHcm91cFRlbXBsYXRlRGlyZWN0aXZlIH0gZnJvbSBcIi4uLy4uL2RpcmVjdGl2ZXMvZHJvcC1kb3duLWxpc3QtZ3JvdXAtdGVtcGxhdGUuZGlyZWN0aXZlXCI7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiBcIm1vbmEtZHJvcC1kb3duLWxpc3RcIixcbiAgICB0ZW1wbGF0ZVVybDogXCIuL2Ryb3AtZG93bi1saXN0LmNvbXBvbmVudC5odG1sXCIsXG4gICAgc3R5bGVVcmxzOiBbXCIuL2Ryb3AtZG93bi1saXN0LmNvbXBvbmVudC5zY3NzXCJdLFxuICAgIHByb3ZpZGVyczogW1BvcHVwTGlzdFNlcnZpY2VdXG59KVxuZXhwb3J0IGNsYXNzIERyb3BEb3duTGlzdENvbXBvbmVudCBleHRlbmRzIEFic3RyYWN0RHJvcERvd25MaXN0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgb3Blbk9uRW50ZXI6IGJvb2xlYW4gPSB0cnVlO1xuICAgIHByb3RlY3RlZCBzZWxlY3Rpb25Nb2RlOiBTZWxlY3Rpb25Nb2RlID0gXCJzaW5nbGVcIjtcbiAgICBwdWJsaWMgb3ZlcnJpZGUgdmFsdWVQb3B1cExpc3RJdGVtPzogUG9wdXBMaXN0SXRlbTtcblxuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIGZpbHRlcmFibGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIEBDb250ZW50Q2hpbGQoRHJvcERvd25MaXN0R3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KVxuICAgIHB1YmxpYyBncm91cFRlbXBsYXRlPzogVGVtcGxhdGVSZWY8YW55PjtcblxuICAgIEBDb250ZW50Q2hpbGQoRHJvcERvd25MaXN0SXRlbVRlbXBsYXRlRGlyZWN0aXZlLCB7IHJlYWQ6IFRlbXBsYXRlUmVmIH0pXG4gICAgcHVibGljIGl0ZW1UZW1wbGF0ZT86IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBvdmVycmlkZSB2YWx1ZT86IGFueTtcblxuICAgIEBPdXRwdXQoKVxuICAgIHB1YmxpYyBvdmVycmlkZSB2YWx1ZUNoYW5nZTogRXZlbnRFbWl0dGVyPGFueSB8IGFueVtdPiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gICAgQENvbnRlbnRDaGlsZChEcm9wRG93bkxpc3RWYWx1ZVRlbXBsYXRlRGlyZWN0aXZlLCB7IHJlYWQ6IFRlbXBsYXRlUmVmIH0pXG4gICAgcHVibGljIHZhbHVlVGVtcGxhdGU/OiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgcmVhZG9ubHkgZWxlbWVudFJlZjogRWxlbWVudFJlZjxIVE1MRWxlbWVudD4sXG4gICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSByZWFkb25seSBwb3B1cExpc3RTZXJ2aWNlOiBQb3B1cExpc3RTZXJ2aWNlLFxuICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgcmVhZG9ubHkgcG9wdXBTZXJ2aWNlOiBQb3B1cFNlcnZpY2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIoZWxlbWVudFJlZiwgcG9wdXBMaXN0U2VydmljZSwgcG9wdXBTZXJ2aWNlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2xlYXJWYWx1ZShldmVudDogTW91c2VFdmVudCk6IHZvaWQge1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy51cGRhdGVWYWx1ZSh1bmRlZmluZWQpO1xuICAgIH1cblxuICAgIHB1YmxpYyBvdmVycmlkZSBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICAgICAgc3VwZXIubmdPbkluaXQoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgb25Qb3B1cExpc3RWYWx1ZUNoYW5nZShldmVudDogUG9wdXBMaXN0VmFsdWVDaGFuZ2VFdmVudCk6IHZvaWQge1xuICAgICAgICBpZiAoIWV2ZW50LnZhbHVlIHx8IGV2ZW50LnZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZhbHVlICYmIGV2ZW50LnZhbHVlWzBdLmRhdGFFcXVhbHModGhpcy52YWx1ZSkpIHtcbiAgICAgICAgICAgIGlmIChldmVudC52aWEgPT09IFwic2VsZWN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50LnZpYSA9PT0gXCJzZWxlY3Rpb25cIikge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlVmFsdWUoZXZlbnQudmFsdWVbMF0pO1xuICAgIH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJtb25hLWRyb3Bkb3duIG1vbmEtZHJvcGRvd24tbGlzdCBtb25hLWlucHV0LXNlbGVjdG9yXCIgW25nQ2xhc3NdPVwieydtb25hLWRpc2FibGVkJzogZGlzYWJsZWR9XCIgW2F0dHIudGFiaW5kZXhdPVwiZGlzYWJsZWQgPyAtMSA6IDBcIiAoY2xpY2spPVwib3BlbigpXCIgI2Ryb3Bkb3duV3JhcHBlcj5cbiAgICA8ZGl2IGNsYXNzPVwibW9uYS1pbnB1dC1zZWxlY3Rvci12YWx1ZVwiPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIXZhbHVlVGVtcGxhdGVcIj5cbiAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwidmFsdWVQb3B1cExpc3RJdGVtXCI+e3t2YWx1ZVBvcHVwTGlzdEl0ZW0/LnRleHR9fTwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwiIXZhbHVlUG9wdXBMaXN0SXRlbVwiPnt7cGxhY2Vob2xkZXJ9fTwvc3Bhbj5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJ2YWx1ZVRlbXBsYXRlXCI+XG4gICAgICAgICAgICA8bmctY29udGFpbmVyIFtuZ1RlbXBsYXRlT3V0bGV0XT1cInZhbHVlVGVtcGxhdGVcIiBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyRpbXBsaWNpdDogdmFsdWVQb3B1cExpc3RJdGVtPy5kYXRhLCBsaXN0SXRlbTogdmFsdWVQb3B1cExpc3RJdGVtfVwiPjwvbmctY29udGFpbmVyPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwibW9uYS1pbnB1dC1zZWxlY3Rvci1pY29uXCIgKm5nSWY9XCJzaG93Q2xlYXJCdXR0b24gJiYgdmFsdWVQb3B1cExpc3RJdGVtXCI+XG4gICAgICAgIDxidXR0b24gbW9uYUJ1dHRvbiBbZmxhdF09XCJ0cnVlXCIgKGNsaWNrKT1cImNsZWFyVmFsdWUoJGV2ZW50KVwiIGNsYXNzPVwibW9uYS1kcm9wZG93bi1jbGVhci1pY29uXCI+XG4gICAgICAgICAgICA8ZmEtaWNvbiBbaWNvbl09XCJjbGVhckljb25cIj48L2ZhLWljb24+XG4gICAgICAgIDwvYnV0dG9uPlxuICAgIDwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJtb25hLWlucHV0LXNlbGVjdG9yLWljb25cIj5cbiAgICAgICAgPGZhLWljb24gW2ljb25dPVwiZHJvcGRvd25JY29uXCI+PC9mYS1pY29uPlxuICAgIDwvZGl2PlxuPC9kaXY+XG5cbjxuZy10ZW1wbGF0ZSAjcG9wdXBUZW1wbGF0ZT5cbiAgICA8ZGl2ICpuZ0lmPVwiISFwb3B1cFJlZlwiPlxuICAgICAgICA8bW9uYS1wb3B1cC1saXN0IFt0ZXh0RmllbGRdPVwidGV4dEZpZWxkXCIgW3ZhbHVlRmllbGRdPVwidmFsdWVGaWVsZFwiIFtncm91cEZpZWxkXT1cImdyb3VwRmllbGRcIiBbdmFsdWVdPVwidmFsdWUgPyBbdmFsdWVdIDogW11cIlxuICAgICAgICAgICAgICAgICAgICAgICAgIFtmaWx0ZXJhYmxlXT1cImZpbHRlcmFibGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICh2YWx1ZUNoYW5nZSk9XCJvblBvcHVwTGlzdFZhbHVlQ2hhbmdlKCRldmVudClcIj5cbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJpdGVtVGVtcGxhdGVcIj5cbiAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgbW9uYUxpc3RJdGVtVGVtcGxhdGUgbGV0LWRhdGFJdGVtIGxldC1saXN0SXRlbT1cImxpc3RJdGVtXCI+XG4gICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgW25nVGVtcGxhdGVPdXRsZXRdPVwiaXRlbVRlbXBsYXRlID8/IG51bGxcIiBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyRpbXBsaWNpdDogZGF0YUl0ZW0sIGxpc3RJdGVtfVwiPjwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJncm91cFRlbXBsYXRlXCI+XG4gICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlIG1vbmFMaXN0R3JvdXBUZW1wbGF0ZSBsZXQtZGF0YUl0ZW0gbGV0LWxpc3RJdGVtPVwibGlzdEl0ZW1cIj5cbiAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciBbbmdUZW1wbGF0ZU91dGxldF09XCJncm91cFRlbXBsYXRlID8/IG51bGxcIiBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyRpbXBsaWNpdDogZGF0YUl0ZW0sIGxpc3RJdGVtfVwiPjwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPC9tb25hLXBvcHVwLWxpc3Q+XG4gICAgPC9kaXY+XG48L25nLXRlbXBsYXRlPlxuIl19