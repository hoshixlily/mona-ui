import { ChangeDetectionStrategy, Component, ContentChildren, EventEmitter, Input, Output, QueryList, ViewChild } from "@angular/core";
import { GridService } from "../../services/grid.service";
import { faArrowDownLong, faArrowUpLong } from "@fortawesome/free-solid-svg-icons";
import { GridColumnComponent } from "../grid-column/grid-column.component";
import { Subject, takeUntil } from "rxjs";
import { Enumerable } from "@mirei/ts-collections";
import * as i0 from "@angular/core";
import * as i1 from "../../services/grid.service";
import * as i2 from "@angular/common";
import * as i3 from "@fortawesome/angular-fontawesome";
import * as i4 from "../../../pager/components/pager/pager.component";
import * as i5 from "@angular/cdk/drag-drop";
import * as i6 from "../../../buttons/modules/chip/components/chip/chip.component";
import * as i7 from "../grid-list/grid-list.component";
import * as i8 from "../../directives/grid-column-resize-handler.directive";
import * as i9 from "../grid-filter-menu/grid-filter-menu.component";
import * as i10 from "../../pipes/grid-filter.pipe";
import * as i11 from "../../pipes/grid-page.pipe";
export class GridComponent {
    #destroy$;
    #filter;
    #sort;
    set data(value) {
        this.gridService.setRows(value);
    }
    set filter(value) {
        if (this.#filter !== value) {
            this.#filter = value;
            this.gridService.loadFilters(value);
        }
    }
    get filter() {
        return this.#filter;
    }
    set gridHeaderElement(value) {
        this.gridService.gridHeaderElement = value.nativeElement;
        window.setTimeout(() => this.setInitialCalculatedWidthOfColumns());
    }
    set pageSize(value) {
        this.gridService.pageState.take = value;
    }
    set sort(value) {
        if (this.#sort !== value) {
            this.#sort = value;
            this.gridService.loadSorts(value);
        }
    }
    get sort() {
        return this.#sort;
    }
    set sortable(options) {
        if (typeof options === "boolean") {
            this.gridService.setSortableOptions({ enabled: true });
        }
        else {
            this.gridService.setSortableOptions(options);
        }
    }
    constructor(gridService, cdr, elementRef) {
        this.gridService = gridService;
        this.cdr = cdr;
        this.elementRef = elementRef;
        this.#destroy$ = new Subject();
        this.#filter = [];
        this.#sort = [];
        this.ascendingSortIcon = faArrowUpLong;
        this.descendingSortIcon = faArrowDownLong;
        this.columnDragging = false;
        this.gridColumns = [];
        this.groupPanelPlaceholderVisible = true;
        this.resizing = false;
        this.cellEdit = new EventEmitter();
        this.columns = new QueryList();
        this.filterable = false;
        this.filterChange = new EventEmitter();
        this.groupable = false;
        this.pageSizeValues = [];
        this.reorderable = false;
        this.resizable = false;
        this.sortChange = new EventEmitter();
    }
    ngAfterContentInit() {
        const processColumns = () => {
            this.gridColumns = this.columns.map(c => c.column);
            this.gridService.columns = this.gridColumns;
            this.gridService.columns.forEach((c, i) => (c.index = i));
            if (this.filter.length !== 0) {
                this.gridService.loadFilters(this.filter);
            }
            if (this.sort.length !== 0) {
                this.gridService.loadSorts(this.sort);
            }
        };
        processColumns();
        this.columns.changes.pipe(takeUntil(this.#destroy$)).subscribe(() => {
            processColumns();
        });
    }
    ngAfterViewInit() {
        this.cdr.detectChanges();
    }
    ngOnChanges(changes) { }
    ngOnDestroy() {
        this.#destroy$.next();
        this.#destroy$.complete();
    }
    ngOnInit() {
        this.setSubscriptions();
    }
    onColumnDragEnter(event, column) {
        this.groupPanelPlaceholderVisible = event.container !== this.groupColumnList;
    }
    onColumnDragStart(event) {
        if (this.resizing) {
            return;
        }
        this.columnDragging = true;
        this.dragColumn = event.source.data;
    }
    onColumnDrop(event) {
        if (!this.dropColumn || !this.dragColumn || !this.columnDragging || this.resizing || !this.reorderable) {
            return;
        }
        const dropColumnIndex = this.gridService.columns.findIndex(c => c.field === this.dropColumn?.field);
        const dragColumnIndex = this.gridService.columns.findIndex(c => c.field === this.dragColumn?.field);
        this.gridService.columns.splice(dropColumnIndex, 0, this.gridService.columns.splice(dragColumnIndex, 1)[0]);
        this.gridService.columns.forEach((c, i) => (c.index = i));
        this.gridService.columns = [...this.gridService.columns];
        this.columnDragging = false;
        this.dragColumn = undefined;
        this.dropColumn = undefined;
    }
    onColumnDropForGrouping(event) {
        if (!this.groupable) {
            return;
        }
        const column = event.item.data;
        this.gridService.groupColumns = [...this.gridService.groupColumns, column];
        if (!this.gridService.appliedSorts.containsKey(column.field)) {
            this.onColumnSort(column);
        }
        this.columnDragging = false;
        this.dragColumn = undefined;
        this.dropColumn = undefined;
    }
    onColumnFilter(column, state) {
        if (state.filter && state.filter.filters.length > 0) {
            this.gridService.appliedFilters.put(column.field, state);
            column.filtered = true;
        }
        else {
            this.gridService.appliedFilters.remove(column.field);
            column.filtered = false;
        }
        this.gridService.appliedFilters = this.gridService.appliedFilters.toDictionary(p => p.key, p => p.value);
        const allFilters = this.gridService.appliedFilters
            .values()
            .select(p => p.filter)
            .where(f => f != null);
        if (allFilters.any()) {
            this.#filter = allFilters.toArray();
        }
        else {
            this.#filter = [];
        }
        this.filterChange.emit(this.#filter);
    }
    onColumnMouseEnter(event, column) {
        if (!this.columnDragging || this.resizing) {
            return;
        }
        this.dropColumn = column;
    }
    onColumnSort(column) {
        if (!this.gridService.sortableOptions.enabled) {
            return;
        }
        if (column.sortDirection == null) {
            column.sortDirection = "asc";
        }
        else if (column.sortDirection === "asc") {
            column.sortDirection = "desc";
        }
        else {
            if (this.gridService.groupColumns.map(c => c.field).includes(column.field)) {
                column.sortDirection = "asc";
            }
            else {
                if (this.gridService.sortableOptions.allowUnsort) {
                    column.sortDirection = undefined;
                    column.sortIndex = undefined;
                }
                else {
                    column.sortDirection = "asc";
                }
            }
        }
        this.applyColumnSort(column, column.sortDirection);
        this.#sort = this.gridService.appliedSorts
            .values()
            .select(s => s.sort)
            .toArray();
        this.sortChange.emit(this.#sort);
    }
    onGroupingColumnRemove(event, column) {
        event.stopPropagation();
        this.gridService.groupColumns = this.gridService.groupColumns.filter(c => c.field !== column.field);
        this.gridService.gridGroupExpandState = this.gridService.gridGroupExpandState
            .where(p => !p.key.startsWith(column.field))
            .toDictionary(p => p.key, p => p.value);
        this.applyColumnSort(column, undefined);
        this.groupPanelPlaceholderVisible = this.gridService.groupColumns.length === 0;
    }
    onPageChange(event) {
        this.gridService.pageState = {
            page: event.page,
            skip: event.skip,
            take: event.take
        };
        const scrollableElement = this.elementRef.nativeElement.querySelector("div.mona-grid-list");
        if (scrollableElement) {
            scrollableElement.scrollTop = 0;
        }
        this.cdr.detectChanges();
    }
    onPageSizeChange(data) {
        this.gridService.pageState = {
            page: 1,
            skip: 0,
            take: data.newPageSize
        };
        this.cdr.detectChanges();
    }
    applyColumnSort(column, sortDirection) {
        column.sortDirection = sortDirection;
        if (this.gridService.sortableOptions.mode === "single") {
            Enumerable.from(this.gridService.columns)
                .where(c => c.field !== column.field)
                .forEach(c => {
                c.sortDirection = undefined;
                c.sortIndex = undefined;
                this.gridService.appliedSorts.remove(c.field);
            });
        }
        if (column.sortDirection != null) {
            const sortDescriptor = {
                field: column.field,
                dir: column.sortDirection
            };
            this.gridService.appliedSorts.put(column.field, { sort: sortDescriptor });
        }
        else {
            this.gridService.appliedSorts.remove(column.field);
            column.sortIndex = undefined;
        }
        this.gridService.appliedSorts.keys().forEach((field, fx) => {
            const col = this.gridService.columns.find(c => c.field === field);
            if (col) {
                col.sortIndex = fx + 1;
            }
        });
        this.gridService.appliedSorts = this.gridService.appliedSorts.toDictionary(p => p.key, p => p.value);
    }
    setInitialCalculatedWidthOfColumns() {
        if (this.gridService.gridHeaderElement) {
            const thList = this.gridService.gridHeaderElement?.querySelectorAll("th");
            for (const [cx, column] of Array.from(thList).entries()) {
                this.gridService.columns[cx].calculatedWidth = column.offsetWidth;
            }
        }
    }
    setSubscriptions() {
        this.gridService.cellEdit$
            .pipe(takeUntil(this.#destroy$))
            .subscribe((event) => this.cellEdit.emit(event));
    }
    get headerMargin() {
        const rightMargin = 12;
        return `0 ${rightMargin}px 0 0`;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.0.0", ngImport: i0, type: GridComponent, deps: [{ token: i1.GridService }, { token: i0.ChangeDetectorRef }, { token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.0.0", type: GridComponent, selector: "mona-grid", inputs: { data: "data", filter: "filter", groupable: "groupable", pageSize: "pageSize", pageSizeValues: "pageSizeValues", reorderable: "reorderable", resizable: "resizable", sort: "sort", sortable: "sortable" }, outputs: { cellEdit: "cellEdit", filterChange: "filterChange", sortChange: "sortChange" }, providers: [GridService], queries: [{ propertyName: "columns", predicate: GridColumnComponent }], viewQueries: [{ propertyName: "gridHeaderElement", first: true, predicate: ["gridHeaderElement"], descendants: true }, { propertyName: "groupColumnList", first: true, predicate: ["groupColumnList"], descendants: true }], usesOnChanges: true, ngImport: i0, template: "<div class=\"mona-grid\">\n    <div class=\"mona-grid-group-panel\" cdkDropList #groupColumnList=\"cdkDropList\" cdkDropListOrientation=\"horizontal\"\n         (cdkDropListDropped)=\"onColumnDropForGrouping($event)\" *ngIf=\"groupable\">\n        <ng-container *ngIf=\"gridService.groupColumns.length !== 0; else noGroupColumnsTemplate;\">\n            <mona-chip *ngFor=\"let groupColumn of gridService.groupColumns\" [removable]=\"true\" (remove)=\"onGroupingColumnRemove($event, groupColumn)\">\n                <span>{{groupColumn.title}}</span>\n            </mona-chip>\n        </ng-container>\n        <ng-template #noGroupColumnsTemplate>\n            <span class=\"mona-grid-group-panel-placeholder\" *ngIf=\"groupPanelPlaceholderVisible\">Drag a column header here to group</span>\n        </ng-template>\n    </div>\n    <div class=\"mona-grid-header\" [ngStyle]=\"{'margin': headerMargin}\" #gridHeaderElement>\n        <div class=\"mona-grid-header-wrap\">\n            <table>\n                <colgroup>\n                    <col *ngFor=\"let _ of gridService.groupColumns\" style=\"width: 34px;\">\n                    <col *ngFor=\"let column of gridService.columns\" [style.width.px]=\"column.calculatedWidth\" [style.min-width.px]=\"column.minWidth\">\n                </colgroup>\n                <thead>\n                    <tr cdkDropList [cdkDropListConnectedTo]=\"groupable ? [groupColumnList!] : []\" (cdkDropListDropped)=\"onColumnDrop($event)\">\n                        <td *ngFor=\"let _ of gridService.groupColumns\"></td>\n                        <th *ngFor=\"let column of gridService.columns\" cdkDrag [cdkDragData]=\"column\" [cdkDragDisabled]=\"!reorderable && !groupable\"\n                            (mousemove)=\"onColumnMouseEnter($event, column)\" (cdkDragEntered)=\"onColumnDragEnter($event, column)\"\n                            (cdkDragStarted)=\"onColumnDragStart($event)\">\n                            <div class=\"mona-grid-column-wrap\">\n                                <span class=\"mona-grid-column-title\" (click)=\"onColumnSort(column)\">{{column.title}}</span>\n                                <div class=\"mona-grid-column-actions\">\n                                    <span *ngIf=\"gridService.sortableOptions.showIndices && column.sortIndex != null\">{{column.sortIndex}}</span>\n                                    <fa-icon [icon]=\"ascendingSortIcon\" *ngIf=\"column.sortDirection==='asc'\"></fa-icon>\n                                    <fa-icon [icon]=\"descendingSortIcon\" *ngIf=\"column.sortDirection==='desc'\"></fa-icon>\n                                    <mona-grid-filter-menu [column]=\"column\" [type]=\"column.filterType\" (apply)=\"onColumnFilter(column, $event)\"\n                                                           *ngIf=\"filterable\"></mona-grid-filter-menu>\n                                </div>\n                            </div>\n                            <span class=\"mona-grid-column-drop-hint\" *ngIf=\"dropColumn === column && dragColumn && reorderable\"\n                                  [ngStyle]=\"{'right': dragColumn.index < dropColumn.index ? '-1px': null, 'left': dragColumn.index > dropColumn.index ? '-1px': null}\"></span>\n                            <div monaGridColumnResizeHandler [column]=\"column\" class=\"mona-grid-column-resizer\" *ngIf=\"resizable && !columnDragging\"\n                                 (resizeStart)=\"resizing=true;\" (resizeEnd)=\"resizing=false;\"></div>\n                            <ng-template cdkDragPreview>\n                                <div class=\"mona-grid-column-drag-preview\">\n                                    <span class=\"mona-grid-column-title\">{{column.title}}</span>\n                                </div>\n                            </ng-template>\n                        </th>\n                    </tr>\n                </thead>\n            </table>\n        </div>\n    </div>\n    <ng-container *ngIf=\"(gridService.rows|gridFilter:gridService.appliedFilters:gridService.appliedSorts) as filteredData\">\n        <ng-container *ngIf=\"filteredData|gridPage:gridService.pageState.skip:gridService.pageState.take as viewData\">\n            <mona-grid-list [columns]=\"gridService.columns\" [data]=\"viewData\"></mona-grid-list>\n            <mona-pager [skip]=\"gridService.pageState.skip\" [pageSize]=\"gridService.pageState.take\" [total]=\"filteredData.length\"\n                        [pageInput]=\"true\" [pageSizeValues]=\"pageSizeValues\" (pageSizeChange)=\"onPageSizeChange($event)\"\n                        (pageChange)=\"onPageChange($event)\"></mona-pager>\n        </ng-container>\n    </ng-container>\n</div>\n", styles: [":host{position:relative;display:block;overflow:hidden}div.mona-grid{height:100%;display:flex;flex-direction:column;background:var(--mona-background-dark);border:1px solid var(--mona-border-color)}.mona-grid-group-panel{display:flex;align-items:center;padding:5px;height:40px;border-bottom:1px solid var(--mona-border-color)}.mona-grid-group-panel mona-chip{margin-right:5px}.mona-grid-group-panel-placeholder{opacity:.7}.mona-grid-header{background-color:var(--mona-background-dark);border-right:1px solid var(--mona-border-color);overflow:hidden;display:flex;flex-direction:row;flex:0 0 auto}.mona-grid-header table{border-collapse:collapse;table-layout:fixed;width:100%}.mona-grid-header table tr{position:relative}.mona-grid-header table th{white-space:nowrap;text-overflow:ellipsis;text-align:left;position:relative;-webkit-user-select:none;user-select:none}.mona-grid-header table th:not(:last-child){border-right:1px solid var(--mona-border-color)}mona-grid-list{border-top:1px solid var(--mona-border-color)}div.mona-grid-column-resizer{position:absolute;top:0;bottom:0;width:10px;background-color:transparent;cursor:col-resize;z-index:1;right:-5px}div.mona-grid-column-wrap{width:100%;height:100%;display:flex;align-items:center;justify-content:space-between;cursor:pointer}span.mona-grid-column-title{flex:1;padding:10px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-weight:700}div.mona-grid-column-actions{display:flex;align-items:center;justify-content:center;padding:0 4px}span.mona-grid-column-drop-hint{position:absolute;display:flex;width:2px;height:100%;background:var(--mona-primary);z-index:1;top:0;bottom:0}\n"], dependencies: [{ kind: "directive", type: i2.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { kind: "component", type: i3.FaIconComponent, selector: "fa-icon", inputs: ["icon", "title", "spin", "pulse", "mask", "styles", "flip", "size", "pull", "border", "inverse", "symbol", "rotate", "fixedWidth", "classes", "transform", "a11yRole"] }, { kind: "component", type: i4.PagerComponent, selector: "mona-pager", inputs: ["firstLast", "pageInput", "pageSize", "previousNext", "pageSizeValues", "skip", "total", "type", "visiblePages"], outputs: ["pageChange", "pageSizeChange"] }, { kind: "directive", type: i5.CdkDropList, selector: "[cdkDropList], cdk-drop-list", inputs: ["cdkDropListConnectedTo", "cdkDropListData", "cdkDropListOrientation", "id", "cdkDropListLockAxis", "cdkDropListDisabled", "cdkDropListSortingDisabled", "cdkDropListEnterPredicate", "cdkDropListSortPredicate", "cdkDropListAutoScrollDisabled", "cdkDropListAutoScrollStep"], outputs: ["cdkDropListDropped", "cdkDropListEntered", "cdkDropListExited", "cdkDropListSorted"], exportAs: ["cdkDropList"] }, { kind: "directive", type: i5.CdkDrag, selector: "[cdkDrag]", inputs: ["cdkDragData", "cdkDragLockAxis", "cdkDragRootElement", "cdkDragBoundary", "cdkDragStartDelay", "cdkDragFreeDragPosition", "cdkDragDisabled", "cdkDragConstrainPosition", "cdkDragPreviewClass", "cdkDragPreviewContainer"], outputs: ["cdkDragStarted", "cdkDragReleased", "cdkDragEnded", "cdkDragEntered", "cdkDragExited", "cdkDragDropped", "cdkDragMoved"], exportAs: ["cdkDrag"] }, { kind: "directive", type: i5.CdkDragPreview, selector: "ng-template[cdkDragPreview]", inputs: ["data", "matchSize"] }, { kind: "component", type: i6.ChipComponent, selector: "mona-chip", inputs: ["disabled", "label", "removable", "tabindex"], outputs: ["remove"] }, { kind: "component", type: i7.GridListComponent, selector: "mona-grid-list", inputs: ["columns", "data"] }, { kind: "directive", type: i8.GridColumnResizeHandlerDirective, selector: "[monaGridColumnResizeHandler]", inputs: ["column"], outputs: ["resizeEnd", "resizeStart"] }, { kind: "component", type: i9.GridFilterMenuComponent, selector: "mona-grid-filter-menu", inputs: ["column", "type"], outputs: ["apply"] }, { kind: "pipe", type: i10.GridFilterPipe, name: "gridFilter" }, { kind: "pipe", type: i11.GridPagePipe, name: "gridPage" }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.0.0", ngImport: i0, type: GridComponent, decorators: [{
            type: Component,
            args: [{ selector: "mona-grid", changeDetection: ChangeDetectionStrategy.OnPush, providers: [GridService], template: "<div class=\"mona-grid\">\n    <div class=\"mona-grid-group-panel\" cdkDropList #groupColumnList=\"cdkDropList\" cdkDropListOrientation=\"horizontal\"\n         (cdkDropListDropped)=\"onColumnDropForGrouping($event)\" *ngIf=\"groupable\">\n        <ng-container *ngIf=\"gridService.groupColumns.length !== 0; else noGroupColumnsTemplate;\">\n            <mona-chip *ngFor=\"let groupColumn of gridService.groupColumns\" [removable]=\"true\" (remove)=\"onGroupingColumnRemove($event, groupColumn)\">\n                <span>{{groupColumn.title}}</span>\n            </mona-chip>\n        </ng-container>\n        <ng-template #noGroupColumnsTemplate>\n            <span class=\"mona-grid-group-panel-placeholder\" *ngIf=\"groupPanelPlaceholderVisible\">Drag a column header here to group</span>\n        </ng-template>\n    </div>\n    <div class=\"mona-grid-header\" [ngStyle]=\"{'margin': headerMargin}\" #gridHeaderElement>\n        <div class=\"mona-grid-header-wrap\">\n            <table>\n                <colgroup>\n                    <col *ngFor=\"let _ of gridService.groupColumns\" style=\"width: 34px;\">\n                    <col *ngFor=\"let column of gridService.columns\" [style.width.px]=\"column.calculatedWidth\" [style.min-width.px]=\"column.minWidth\">\n                </colgroup>\n                <thead>\n                    <tr cdkDropList [cdkDropListConnectedTo]=\"groupable ? [groupColumnList!] : []\" (cdkDropListDropped)=\"onColumnDrop($event)\">\n                        <td *ngFor=\"let _ of gridService.groupColumns\"></td>\n                        <th *ngFor=\"let column of gridService.columns\" cdkDrag [cdkDragData]=\"column\" [cdkDragDisabled]=\"!reorderable && !groupable\"\n                            (mousemove)=\"onColumnMouseEnter($event, column)\" (cdkDragEntered)=\"onColumnDragEnter($event, column)\"\n                            (cdkDragStarted)=\"onColumnDragStart($event)\">\n                            <div class=\"mona-grid-column-wrap\">\n                                <span class=\"mona-grid-column-title\" (click)=\"onColumnSort(column)\">{{column.title}}</span>\n                                <div class=\"mona-grid-column-actions\">\n                                    <span *ngIf=\"gridService.sortableOptions.showIndices && column.sortIndex != null\">{{column.sortIndex}}</span>\n                                    <fa-icon [icon]=\"ascendingSortIcon\" *ngIf=\"column.sortDirection==='asc'\"></fa-icon>\n                                    <fa-icon [icon]=\"descendingSortIcon\" *ngIf=\"column.sortDirection==='desc'\"></fa-icon>\n                                    <mona-grid-filter-menu [column]=\"column\" [type]=\"column.filterType\" (apply)=\"onColumnFilter(column, $event)\"\n                                                           *ngIf=\"filterable\"></mona-grid-filter-menu>\n                                </div>\n                            </div>\n                            <span class=\"mona-grid-column-drop-hint\" *ngIf=\"dropColumn === column && dragColumn && reorderable\"\n                                  [ngStyle]=\"{'right': dragColumn.index < dropColumn.index ? '-1px': null, 'left': dragColumn.index > dropColumn.index ? '-1px': null}\"></span>\n                            <div monaGridColumnResizeHandler [column]=\"column\" class=\"mona-grid-column-resizer\" *ngIf=\"resizable && !columnDragging\"\n                                 (resizeStart)=\"resizing=true;\" (resizeEnd)=\"resizing=false;\"></div>\n                            <ng-template cdkDragPreview>\n                                <div class=\"mona-grid-column-drag-preview\">\n                                    <span class=\"mona-grid-column-title\">{{column.title}}</span>\n                                </div>\n                            </ng-template>\n                        </th>\n                    </tr>\n                </thead>\n            </table>\n        </div>\n    </div>\n    <ng-container *ngIf=\"(gridService.rows|gridFilter:gridService.appliedFilters:gridService.appliedSorts) as filteredData\">\n        <ng-container *ngIf=\"filteredData|gridPage:gridService.pageState.skip:gridService.pageState.take as viewData\">\n            <mona-grid-list [columns]=\"gridService.columns\" [data]=\"viewData\"></mona-grid-list>\n            <mona-pager [skip]=\"gridService.pageState.skip\" [pageSize]=\"gridService.pageState.take\" [total]=\"filteredData.length\"\n                        [pageInput]=\"true\" [pageSizeValues]=\"pageSizeValues\" (pageSizeChange)=\"onPageSizeChange($event)\"\n                        (pageChange)=\"onPageChange($event)\"></mona-pager>\n        </ng-container>\n    </ng-container>\n</div>\n", styles: [":host{position:relative;display:block;overflow:hidden}div.mona-grid{height:100%;display:flex;flex-direction:column;background:var(--mona-background-dark);border:1px solid var(--mona-border-color)}.mona-grid-group-panel{display:flex;align-items:center;padding:5px;height:40px;border-bottom:1px solid var(--mona-border-color)}.mona-grid-group-panel mona-chip{margin-right:5px}.mona-grid-group-panel-placeholder{opacity:.7}.mona-grid-header{background-color:var(--mona-background-dark);border-right:1px solid var(--mona-border-color);overflow:hidden;display:flex;flex-direction:row;flex:0 0 auto}.mona-grid-header table{border-collapse:collapse;table-layout:fixed;width:100%}.mona-grid-header table tr{position:relative}.mona-grid-header table th{white-space:nowrap;text-overflow:ellipsis;text-align:left;position:relative;-webkit-user-select:none;user-select:none}.mona-grid-header table th:not(:last-child){border-right:1px solid var(--mona-border-color)}mona-grid-list{border-top:1px solid var(--mona-border-color)}div.mona-grid-column-resizer{position:absolute;top:0;bottom:0;width:10px;background-color:transparent;cursor:col-resize;z-index:1;right:-5px}div.mona-grid-column-wrap{width:100%;height:100%;display:flex;align-items:center;justify-content:space-between;cursor:pointer}span.mona-grid-column-title{flex:1;padding:10px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-weight:700}div.mona-grid-column-actions{display:flex;align-items:center;justify-content:center;padding:0 4px}span.mona-grid-column-drop-hint{position:absolute;display:flex;width:2px;height:100%;background:var(--mona-primary);z-index:1;top:0;bottom:0}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.GridService }, { type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, propDecorators: { cellEdit: [{
                type: Output
            }], columns: [{
                type: ContentChildren,
                args: [GridColumnComponent]
            }], data: [{
                type: Input
            }], filter: [{
                type: Input
            }], filterChange: [{
                type: Output
            }], gridHeaderElement: [{
                type: ViewChild,
                args: ["gridHeaderElement"]
            }], groupColumnList: [{
                type: ViewChild,
                args: ["groupColumnList"]
            }], groupable: [{
                type: Input
            }], pageSize: [{
                type: Input
            }], pageSizeValues: [{
                type: Input
            }], reorderable: [{
                type: Input
            }], resizable: [{
                type: Input
            }], sort: [{
                type: Input
            }], sortChange: [{
                type: Output
            }], sortable: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JpZC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9tb25hLXVpL3NyYy9saWIvZ3JpZC9jb21wb25lbnRzL2dyaWQvZ3JpZC5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9tb25hLXVpL3NyYy9saWIvZ3JpZC9jb21wb25lbnRzL2dyaWQvZ3JpZC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBR0gsdUJBQXVCLEVBRXZCLFNBQVMsRUFDVCxlQUFlLEVBRWYsWUFBWSxFQUNaLEtBQUssRUFJTCxNQUFNLEVBQ04sU0FBUyxFQUVULFNBQVMsRUFDWixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDMUQsT0FBTyxFQUFFLGVBQWUsRUFBRSxhQUFhLEVBQWtCLE1BQU0sbUNBQW1DLENBQUM7QUFNbkcsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFHM0UsT0FBTyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFFMUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHVCQUF1QixDQUFDOzs7Ozs7Ozs7Ozs7O0FBVW5ELE1BQU0sT0FBTyxhQUFhO0lBQ3RCLFNBQVMsQ0FBc0M7SUFDL0MsT0FBTyxDQUFtQztJQUMxQyxLQUFLLENBQXdCO0lBZ0I3QixJQUNXLElBQUksQ0FBQyxLQUFZO1FBQ3hCLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFRCxJQUNXLE1BQU0sQ0FBQyxLQUFrQztRQUNoRCxJQUFJLElBQUksQ0FBQyxPQUFPLEtBQUssS0FBSyxFQUFFO1lBQ3hCLElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1lBQ3JCLElB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U0FBUyxDQUFDLENBQUMsS0FBb0IsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUN4RSxDQUFDO0lBRUQsSUFBVyxZQUFZO1FBQ25CLE1BQU0sV0FBVyxHQUFHLEVBQUUsQ0FBQztRQUN2QixPQUFPLEtBQUssV0FBVyxRQUFRLENBQUM7SUFDcEMsQ0FBQzs4R0EzVFEsYUFBYTtrR0FBYixhQUFhLG1WQUZYLENBQUMsV0FBVyxDQUFDLGtEQWtCUCxtQkFBbUIsK1FDeER4QyxvbUpBMkRBOzsyRkRuQmEsYUFBYTtrQkFQekIsU0FBUzsrQkFDSSxXQUFXLG1CQUdKLHVCQUF1QixDQUFDLE1BQU0sYUFDcEMsQ0FBQyxXQUFXLENBQUM7MkpBZ0JqQixRQUFRO3NCQURkLE1BQU07Z0JBSUEsT0FBTztzQkFEYixlQUFlO3VCQUFDLG1CQUFtQjtnQkFJekIsSUFBSTtzQkFEZCxLQUFLO2dCQU1LLE1BQU07c0JBRGhCLEtBQUs7Z0JBZUMsWUFBWTtzQkFEbEIsTUFBTTtnQkFJSSxpQkFBaUI7c0JBRDNCLFNBQVM7dUJBQUMsbUJBQW1CO2dCQU92QixlQUFlO3NCQURyQixTQUFTO3VCQUFDLGlCQUFpQjtnQkFJckIsU0FBUztzQkFEZixLQUFLO2dCQUlLLFFBQVE7c0JBRGxCLEtBQUs7Z0JBTUMsY0FBYztzQkFEcEIsS0FBSztnQkFJQyxXQUFXO3NCQURqQixLQUFLO2dCQUlDLFNBQVM7c0JBRGYsS0FBSztnQkFJSyxJQUFJO3NCQURkLEtBQUs7Z0JBYUMsVUFBVTtzQkFEaEIsTUFBTTtnQkFJSSxRQUFRO3NCQURsQixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgICBBZnRlckNvbnRlbnRJbml0LFxuICAgIEFmdGVyVmlld0luaXQsXG4gICAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgQ29tcG9uZW50LFxuICAgIENvbnRlbnRDaGlsZHJlbixcbiAgICBFbGVtZW50UmVmLFxuICAgIEV2ZW50RW1pdHRlcixcbiAgICBJbnB1dCxcbiAgICBPbkNoYW5nZXMsXG4gICAgT25EZXN0cm95LFxuICAgIE9uSW5pdCxcbiAgICBPdXRwdXQsXG4gICAgUXVlcnlMaXN0LFxuICAgIFNpbXBsZUNoYW5nZXMsXG4gICAgVmlld0NoaWxkXG59IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBHcmlkU2VydmljZSB9IGZyb20gXCIuLi8uLi9zZXJ2aWNlcy9ncmlkLnNlcnZpY2VcIjtcbmltcG9ydCB7IGZhQXJyb3dEb3duTG9uZywgZmFBcnJvd1VwTG9uZywgSWNvbkRlZmluaXRpb24gfSBmcm9tIFwiQGZvcnRhd2Vzb21lL2ZyZWUtc29saWQtc3ZnLWljb25zXCI7XG5pbXBvcnQgeyBDb2x1bW4gfSBmcm9tIFwiLi4vLi4vbW9kZWxzL0NvbHVtblwiO1xuaW1wb3J0IHsgU29ydERlc2NyaXB0b3IgfSBmcm9tIFwiLi4vLi4vLi4vcXVlcnkvc29ydC9Tb3J0RGVzY3JpcHRvclwiO1xuaW1wb3J0IHsgQ29sdW1uRmlsdGVyU3RhdGUgfSBmcm9tIFwiLi4vLi4vbW9kZWxzL0NvbHVtbkZpbHRlclN0YXRlXCI7XG5pbXBvcnQgeyBQYWdlU2l6ZUNoYW5nZUV2ZW50IH0gZnJvbSBcIi4uLy4uLy4uL3BhZ2VyL21vZGVscy9QYWdlU2l6ZUNoYW5nZUV2ZW50XCI7XG5pbXBvcnQgeyBQYWdlQ2hhbmdlRXZlbnQgfSBmcm9tIFwiLi4vLi4vLi4vcGFnZXIvbW9kZWxzL1BhZ2VDaGFuZ2VFdmVudFwiO1xuaW1wb3J0IHsgR3JpZENvbHVtbkNvbXBvbmVudCB9IGZyb20gXCIuLi9ncmlkLWNvbHVtbi9ncmlkLWNvbHVtbi5jb21wb25lbnRcIjtcbmltcG9ydCB7IENka0RyYWdEcm9wLCBDZGtEcmFnRW50ZXIsIENka0RyYWdTdGFydCwgQ2RrRHJvcExpc3QgfSBmcm9tIFwiQGFuZ3VsYXIvY2RrL2RyYWctZHJvcFwiO1xuaW1wb3J0IHsgQ29tcG9zaXRlRmlsdGVyRGVzY3JpcHRvciB9IGZyb20gXCIuLi8uLi8uLi9xdWVyeS9maWx0ZXIvRmlsdGVyRGVzY3JpcHRvclwiO1xuaW1wb3J0IHsgU3ViamVjdCwgdGFrZVVudGlsIH0gZnJvbSBcInJ4anNcIjtcbmltcG9ydCB7IFNvcnRhYmxlT3B0aW9ucyB9IGZyb20gXCIuLi8uLi9tb2RlbHMvU29ydGFibGVPcHRpb25zXCI7XG5pbXBvcnQgeyBFbnVtZXJhYmxlIH0gZnJvbSBcIkBtaXJlaS90cy1jb2xsZWN0aW9uc1wiO1xuaW1wb3J0IHsgQ2VsbEVkaXRFdmVudCB9IGZyb20gXCIuLi8uLi9tb2RlbHMvQ2VsbEVkaXRFdmVudFwiO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogXCJtb25hLWdyaWRcIixcbiAgICB0ZW1wbGF0ZVVybDogXCIuL2dyaWQuY29tcG9uZW50Lmh0bWxcIixcbiAgICBzdHlsZVVybHM6IFtcIi4vZ3JpZC5jb21wb25lbnQuc2Nzc1wiXSxcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICBwcm92aWRlcnM6IFtHcmlkU2VydmljZV1cbn0pXG5leHBvcnQgY2xhc3MgR3JpZENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95LCBPbkNoYW5nZXMsIEFmdGVyQ29udGVudEluaXQge1xuICAgICNkZXN0cm95JDogU3ViamVjdDx2b2lkPiA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XG4gICAgI2ZpbHRlcjogQ29tcG9zaXRlRmlsdGVyRGVzY3JpcHRvcltdID0gW107XG4gICAgI3NvcnQ6IFNvcnREZXNjcmlwdG9yW10gPSBbXTtcbiAgICBwdWJsaWMgcmVhZG9ubHkgYXNjZW5kaW5nU29ydEljb246IEljb25EZWZpbml0aW9uID0gZmFBcnJvd1VwTG9uZztcbiAgICBwdWJsaWMgcmVhZG9ubHkgZGVzY2VuZGluZ1NvcnRJY29uOiBJY29uRGVmaW5pdGlvbiA9IGZhQXJyb3dEb3duTG9uZztcbiAgICBwdWJsaWMgY29sdW1uRHJhZ2dpbmc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwdWJsaWMgZHJhZ0NvbHVtbj86IENvbHVtbjtcbiAgICBwdWJsaWMgZHJvcENvbHVtbj86IENvbHVtbjtcbiAgICBwdWJsaWMgZ3JpZENvbHVtbnM6IENvbHVtbltdID0gW107XG4gICAgcHVibGljIGdyb3VwUGFuZWxQbGFjZWhvbGRlclZpc2libGU6IGJvb2xlYW4gPSB0cnVlO1xuICAgIHB1YmxpYyByZXNpemluZzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgQE91dHB1dCgpXG4gICAgcHVibGljIGNlbGxFZGl0OiBFdmVudEVtaXR0ZXI8Q2VsbEVkaXRFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyPENlbGxFZGl0RXZlbnQ+KCk7XG5cbiAgICBAQ29udGVudENoaWxkcmVuKEdyaWRDb2x1bW5Db21wb25lbnQpXG4gICAgcHVibGljIGNvbHVtbnM6IFF1ZXJ5TGlzdDxHcmlkQ29sdW1uQ29tcG9uZW50PiA9IG5ldyBRdWVyeUxpc3Q8R3JpZENvbHVtbkNvbXBvbmVudD4oKTtcblxuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIHNldCBkYXRhKHZhbHVlOiBhbnlbXSkge1xuICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLnNldFJvd3ModmFsdWUpO1xuICAgIH1cblxuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIHNldCBmaWx0ZXIodmFsdWU6IENvbXBvc2l0ZUZpbHRlckRlc2NyaXB0b3JbXSkge1xuICAgICAgICBpZiAodGhpcy4jZmlsdGVyICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy4jZmlsdGVyID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmxvYWRGaWx0ZXJzKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgZmlsdGVyKCk6IENvbXBvc2l0ZUZpbHRlckRlc2NyaXB0b3JbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLiNmaWx0ZXI7XG4gICAgfVxuXG4gICAgcHVibGljIGZpbHRlcmFibGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIEBPdXRwdXQoKVxuICAgIHB1YmxpYyBmaWx0ZXJDaGFuZ2U6IEV2ZW50RW1pdHRlcjxDb21wb3NpdGVGaWx0ZXJEZXNjcmlwdG9yW10+ID0gbmV3IEV2ZW50RW1pdHRlcjxDb21wb3NpdGVGaWx0ZXJEZXNjcmlwdG9yW10+KCk7XG5cbiAgICBAVmlld0NoaWxkKFwiZ3JpZEhlYWRlckVsZW1lbnRcIilcbiAgICBwdWJsaWMgc2V0IGdyaWRIZWFkZXJFbGVtZW50KHZhbHVlOiBFbGVtZW50UmVmPEhUTUxEaXZFbGVtZW50Pikge1xuICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmdyaWRIZWFkZXJFbGVtZW50ID0gdmFsdWUubmF0aXZlRWxlbWVudDtcbiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5zZXRJbml0aWFsQ2FsY3VsYXRlZFdpZHRoT2ZDb2x1bW5zKCkpO1xuICAgIH1cblxuICAgIEBWaWV3Q2hpbGQoXCJncm91cENvbHVtbkxpc3RcIilcbiAgICBwdWJsaWMgZ3JvdXBDb2x1bW5MaXN0PzogQ2RrRHJvcExpc3Q7XG5cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBncm91cGFibGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIHNldCBwYWdlU2l6ZSh2YWx1ZTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuZ3JpZFNlcnZpY2UucGFnZVN0YXRlLnRha2UgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBwYWdlU2l6ZVZhbHVlczogbnVtYmVyW10gPSBbXTtcblxuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIHJlb3JkZXJhYmxlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyByZXNpemFibGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIHNldCBzb3J0KHZhbHVlOiBTb3J0RGVzY3JpcHRvcltdKSB7XG4gICAgICAgIGlmICh0aGlzLiNzb3J0ICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy4jc29ydCA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5ncmlkU2VydmljZS5sb2FkU29ydHModmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBzb3J0KCk6IFNvcnREZXNjcmlwdG9yW10ge1xuICAgICAgICByZXR1cm4gdGhpcy4jc29ydDtcbiAgICB9XG5cbiAgICBAT3V0cHV0KClcbiAgICBwdWJsaWMgc29ydENoYW5nZTogRXZlbnRFbWl0dGVyPFNvcnREZXNjcmlwdG9yW10+ID0gbmV3IEV2ZW50RW1pdHRlcjxTb3J0RGVzY3JpcHRvcltdPigpO1xuXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgc2V0IHNvcnRhYmxlKG9wdGlvbnM6IGJvb2xlYW4gfCBTb3J0YWJsZU9wdGlvbnMpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSBcImJvb2xlYW5cIikge1xuICAgICAgICAgICAgdGhpcy5ncmlkU2VydmljZS5zZXRTb3J0YWJsZU9wdGlvbnMoeyBlbmFibGVkOiB0cnVlIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5ncmlkU2VydmljZS5zZXRTb3J0YWJsZU9wdGlvbnMob3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyByZWFkb25seSBncmlkU2VydmljZTogR3JpZFNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBlbGVtZW50UmVmOiBFbGVtZW50UmVmPEhUTUxFbGVtZW50PlxuICAgICkge31cblxuICAgIHB1YmxpYyBuZ0FmdGVyQ29udGVudEluaXQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHByb2Nlc3NDb2x1bW5zID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5ncmlkQ29sdW1ucyA9IHRoaXMuY29sdW1ucy5tYXAoYyA9PiBjLmNvbHVtbik7XG4gICAgICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmNvbHVtbnMgPSB0aGlzLmdyaWRDb2x1bW5zO1xuICAgICAgICAgICAgdGhpcy5ncmlkU2VydmljZS5jb2x1bW5zLmZvckVhY2goKGMsIGkpID0+IChjLmluZGV4ID0gaSkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmlsdGVyLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZFNlcnZpY2UubG9hZEZpbHRlcnModGhpcy5maWx0ZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc29ydC5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmxvYWRTb3J0cyh0aGlzLnNvcnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBwcm9jZXNzQ29sdW1ucygpO1xuICAgICAgICB0aGlzLmNvbHVtbnMuY2hhbmdlcy5waXBlKHRha2VVbnRpbCh0aGlzLiNkZXN0cm95JCkpLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICBwcm9jZXNzQ29sdW1ucygpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgfVxuXG4gICAgcHVibGljIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHt9XG5cbiAgICBwdWJsaWMgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIHRoaXMuI2Rlc3Ryb3kkLm5leHQoKTtcbiAgICAgICAgdGhpcy4jZGVzdHJveSQuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2V0U3Vic2NyaXB0aW9ucygpO1xuICAgIH1cblxuICAgIHB1YmxpYyBvbkNvbHVtbkRyYWdFbnRlcihldmVudDogQ2RrRHJhZ0VudGVyPHZvaWQsIENvbHVtbj4sIGNvbHVtbjogQ29sdW1uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZ3JvdXBQYW5lbFBsYWNlaG9sZGVyVmlzaWJsZSA9IGV2ZW50LmNvbnRhaW5lciAhPT0gdGhpcy5ncm91cENvbHVtbkxpc3Q7XG4gICAgfVxuXG4gICAgcHVibGljIG9uQ29sdW1uRHJhZ1N0YXJ0KGV2ZW50OiBDZGtEcmFnU3RhcnQ8Q29sdW1uPik6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5yZXNpemluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29sdW1uRHJhZ2dpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLmRyYWdDb2x1bW4gPSBldmVudC5zb3VyY2UuZGF0YTtcbiAgICB9XG5cbiAgICBwdWJsaWMgb25Db2x1bW5Ecm9wKGV2ZW50OiBDZGtEcmFnRHJvcDxDb2x1bW4+KTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5kcm9wQ29sdW1uIHx8ICF0aGlzLmRyYWdDb2x1bW4gfHwgIXRoaXMuY29sdW1uRHJhZ2dpbmcgfHwgdGhpcy5yZXNpemluZyB8fCAhdGhpcy5yZW9yZGVyYWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRyb3BDb2x1bW5JbmRleCA9IHRoaXMuZ3JpZFNlcnZpY2UuY29sdW1ucy5maW5kSW5kZXgoYyA9PiBjLmZpZWxkID09PSB0aGlzLmRyb3BDb2x1bW4/LmZpZWxkKTtcbiAgICAgICAgY29uc3QgZHJhZ0NvbHVtbkluZGV4ID0gdGhpcy5ncmlkU2VydmljZS5jb2x1bW5zLmZpbmRJbmRleChjID0+IGMuZmllbGQgPT09IHRoaXMuZHJhZ0NvbHVtbj8uZmllbGQpO1xuICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmNvbHVtbnMuc3BsaWNlKGRyb3BDb2x1bW5JbmRleCwgMCwgdGhpcy5ncmlkU2VydmljZS5jb2x1bW5zLnNwbGljZShkcmFnQ29sdW1uSW5kZXgsIDEpWzBdKTtcbiAgICAgICAgdGhpcy5ncmlkU2VydmljZS5jb2x1bW5zLmZvckVhY2goKGMsIGkpID0+IChjLmluZGV4ID0gaSkpO1xuICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmNvbHVtbnMgPSBbLi4udGhpcy5ncmlkU2VydmljZS5jb2x1bW5zXTtcbiAgICAgICAgdGhpcy5jb2x1bW5EcmFnZ2luZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRyYWdDb2x1bW4gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuZHJvcENvbHVtbiA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBwdWJsaWMgb25Db2x1bW5Ecm9wRm9yR3JvdXBpbmcoZXZlbnQ6IENka0RyYWdEcm9wPENvbHVtbiwgdm9pZCwgQ29sdW1uPik6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuZ3JvdXBhYmxlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY29sdW1uID0gZXZlbnQuaXRlbS5kYXRhO1xuICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmdyb3VwQ29sdW1ucyA9IFsuLi50aGlzLmdyaWRTZXJ2aWNlLmdyb3VwQ29sdW1ucywgY29sdW1uXTtcbiAgICAgICAgaWYgKCF0aGlzLmdyaWRTZXJ2aWNlLmFwcGxpZWRTb3J0cy5jb250YWluc0tleShjb2x1bW4uZmllbGQpKSB7XG4gICAgICAgICAgICB0aGlzLm9uQ29sdW1uU29ydChjb2x1bW4pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29sdW1uRHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5kcmFnQ29sdW1uID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmRyb3BDb2x1bW4gPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcHVibGljIG9uQ29sdW1uRmlsdGVyKGNvbHVtbjogQ29sdW1uLCBzdGF0ZTogQ29sdW1uRmlsdGVyU3RhdGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKHN0YXRlLmZpbHRlciAmJiBzdGF0ZS5maWx0ZXIuZmlsdGVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmFwcGxpZWRGaWx0ZXJzLnB1dChjb2x1bW4uZmllbGQsIHN0YXRlKTtcbiAgICAgICAgICAgIGNvbHVtbi5maWx0ZXJlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmFwcGxpZWRGaWx0ZXJzLnJlbW92ZShjb2x1bW4uZmllbGQpO1xuICAgICAgICAgICAgY29sdW1uLmZpbHRlcmVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ncmlkU2VydmljZS5hcHBsaWVkRmlsdGVycyA9IHRoaXMuZ3JpZFNlcnZpY2UuYXBwbGllZEZpbHRlcnMudG9EaWN0aW9uYXJ5KFxuICAgICAgICAgICAgcCA9PiBwLmtleSxcbiAgICAgICAgICAgIHAgPT4gcC52YWx1ZVxuICAgICAgICApO1xuICAgICAgICBjb25zdCBhbGxGaWx0ZXJzID0gdGhpcy5ncmlkU2VydmljZS5hcHBsaWVkRmlsdGVyc1xuICAgICAgICAgICAgLnZhbHVlcygpXG4gICAgICAgICAgICAuc2VsZWN0KHAgPT4gcC5maWx0ZXIpXG4gICAgICAgICAgICAud2hlcmUoZiA9PiBmICE9IG51bGwpO1xuICAgICAgICBpZiAoYWxsRmlsdGVycy5hbnkoKSkge1xuICAgICAgICAgICAgdGhpcy4jZmlsdGVyID0gYWxsRmlsdGVycy50b0FycmF5KCkgYXMgQ29tcG9zaXRlRmlsdGVyRGVzY3JpcHRvcltdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy4jZmlsdGVyID0gW107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2UuZW1pdCh0aGlzLiNmaWx0ZXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBvbkNvbHVtbk1vdXNlRW50ZXIoZXZlbnQ6IE1vdXNlRXZlbnQsIGNvbHVtbjogQ29sdW1uKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5jb2x1bW5EcmFnZ2luZyB8fCB0aGlzLnJlc2l6aW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kcm9wQ29sdW1uID0gY29sdW1uO1xuICAgIH1cblxuICAgIHB1YmxpYyBvbkNvbHVtblNvcnQoY29sdW1uOiBDb2x1bW4pOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmdyaWRTZXJ2aWNlLnNvcnRhYmxlT3B0aW9ucy5lbmFibGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtbi5zb3J0RGlyZWN0aW9uID09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbHVtbi5zb3J0RGlyZWN0aW9uID0gXCJhc2NcIjtcbiAgICAgICAgfSBlbHNlIGlmIChjb2x1bW4uc29ydERpcmVjdGlvbiA9PT0gXCJhc2NcIikge1xuICAgICAgICAgICAgY29sdW1uLnNvcnREaXJlY3Rpb24gPSBcImRlc2NcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdyaWRTZXJ2aWNlLmdyb3VwQ29sdW1ucy5tYXAoYyA9PiBjLmZpZWxkKS5pbmNsdWRlcyhjb2x1bW4uZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uLnNvcnREaXJlY3Rpb24gPSBcImFzY1wiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ncmlkU2VydmljZS5zb3J0YWJsZU9wdGlvbnMuYWxsb3dVbnNvcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uLnNvcnREaXJlY3Rpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbi5zb3J0SW5kZXggPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uLnNvcnREaXJlY3Rpb24gPSBcImFzY1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFwcGx5Q29sdW1uU29ydChjb2x1bW4sIGNvbHVtbi5zb3J0RGlyZWN0aW9uKTtcbiAgICAgICAgdGhpcy4jc29ydCA9IHRoaXMuZ3JpZFNlcnZpY2UuYXBwbGllZFNvcnRzXG4gICAgICAgICAgICAudmFsdWVzKClcbiAgICAgICAgICAgIC5zZWxlY3QocyA9PiBzLnNvcnQpXG4gICAgICAgICAgICAudG9BcnJheSgpO1xuICAgICAgICB0aGlzLnNvcnRDaGFuZ2UuZW1pdCh0aGlzLiNzb3J0KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgb25Hcm91cGluZ0NvbHVtblJlbW92ZShldmVudDogRXZlbnQsIGNvbHVtbjogQ29sdW1uKTogdm9pZCB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmdyb3VwQ29sdW1ucyA9IHRoaXMuZ3JpZFNlcnZpY2UuZ3JvdXBDb2x1bW5zLmZpbHRlcihjID0+IGMuZmllbGQgIT09IGNvbHVtbi5maWVsZCk7XG4gICAgICAgIHRoaXMuZ3JpZFNlcnZpY2UuZ3JpZEdyb3VwRXhwYW5kU3RhdGUgPSB0aGlzLmdyaWRTZXJ2aWNlLmdyaWRHcm91cEV4cGFuZFN0YXRlXG4gICAgICAgICAgICAud2hlcmUocCA9PiAhcC5rZXkuc3RhcnRzV2l0aChjb2x1bW4uZmllbGQpKVxuICAgICAgICAgICAgLnRvRGljdGlvbmFyeShcbiAgICAgICAgICAgICAgICBwID0+IHAua2V5LFxuICAgICAgICAgICAgICAgIHAgPT4gcC52YWx1ZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgdGhpcy5hcHBseUNvbHVtblNvcnQoY29sdW1uLCB1bmRlZmluZWQpO1xuICAgICAgICB0aGlzLmdyb3VwUGFuZWxQbGFjZWhvbGRlclZpc2libGUgPSB0aGlzLmdyaWRTZXJ2aWNlLmdyb3VwQ29sdW1ucy5sZW5ndGggPT09IDA7XG4gICAgfVxuXG4gICAgcHVibGljIG9uUGFnZUNoYW5nZShldmVudDogUGFnZUNoYW5nZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuZ3JpZFNlcnZpY2UucGFnZVN0YXRlID0ge1xuICAgICAgICAgICAgcGFnZTogZXZlbnQucGFnZSxcbiAgICAgICAgICAgIHNraXA6IGV2ZW50LnNraXAsXG4gICAgICAgICAgICB0YWtlOiBldmVudC50YWtlXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHNjcm9sbGFibGVFbGVtZW50ID0gdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcihcImRpdi5tb25hLWdyaWQtbGlzdFwiKSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgaWYgKHNjcm9sbGFibGVFbGVtZW50KSB7XG4gICAgICAgICAgICBzY3JvbGxhYmxlRWxlbWVudC5zY3JvbGxUb3AgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgb25QYWdlU2l6ZUNoYW5nZShkYXRhOiBQYWdlU2l6ZUNoYW5nZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuZ3JpZFNlcnZpY2UucGFnZVN0YXRlID0ge1xuICAgICAgICAgICAgcGFnZTogMSxcbiAgICAgICAgICAgIHNraXA6IDAsXG4gICAgICAgICAgICB0YWtlOiBkYXRhLm5ld1BhZ2VTaXplXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFwcGx5Q29sdW1uU29ydChjb2x1bW46IENvbHVtbiwgc29ydERpcmVjdGlvbjogXCJhc2NcIiB8IFwiZGVzY1wiIHwgdW5kZWZpbmVkKTogdm9pZCB7XG4gICAgICAgIGNvbHVtbi5zb3J0RGlyZWN0aW9uID0gc29ydERpcmVjdGlvbjtcbiAgICAgICAgaWYgKHRoaXMuZ3JpZFNlcnZpY2Uuc29ydGFibGVPcHRpb25zLm1vZGUgPT09IFwic2luZ2xlXCIpIHtcbiAgICAgICAgICAgIEVudW1lcmFibGUuZnJvbSh0aGlzLmdyaWRTZXJ2aWNlLmNvbHVtbnMpXG4gICAgICAgICAgICAgICAgLndoZXJlKGMgPT4gYy5maWVsZCAhPT0gY29sdW1uLmZpZWxkKVxuICAgICAgICAgICAgICAgIC5mb3JFYWNoKGMgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjLnNvcnREaXJlY3Rpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIGMuc29ydEluZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmFwcGxpZWRTb3J0cy5yZW1vdmUoYy5maWVsZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtbi5zb3J0RGlyZWN0aW9uICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnN0IHNvcnREZXNjcmlwdG9yOiBTb3J0RGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgICAgICBmaWVsZDogY29sdW1uLmZpZWxkLFxuICAgICAgICAgICAgICAgIGRpcjogY29sdW1uLnNvcnREaXJlY3Rpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmFwcGxpZWRTb3J0cy5wdXQoY29sdW1uLmZpZWxkLCB7IHNvcnQ6IHNvcnREZXNjcmlwdG9yIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5ncmlkU2VydmljZS5hcHBsaWVkU29ydHMucmVtb3ZlKGNvbHVtbi5maWVsZCk7XG4gICAgICAgICAgICBjb2x1bW4uc29ydEluZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZ3JpZFNlcnZpY2UuYXBwbGllZFNvcnRzLmtleXMoKS5mb3JFYWNoKChmaWVsZCwgZngpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbCA9IHRoaXMuZ3JpZFNlcnZpY2UuY29sdW1ucy5maW5kKGMgPT4gYy5maWVsZCA9PT0gZmllbGQpO1xuICAgICAgICAgICAgaWYgKGNvbCkge1xuICAgICAgICAgICAgICAgIGNvbC5zb3J0SW5kZXggPSBmeCArIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdyaWRTZXJ2aWNlLmFwcGxpZWRTb3J0cyA9IHRoaXMuZ3JpZFNlcnZpY2UuYXBwbGllZFNvcnRzLnRvRGljdGlvbmFyeShcbiAgICAgICAgICAgIHAgPT4gcC5rZXksXG4gICAgICAgICAgICBwID0+IHAudmFsdWVcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldEluaXRpYWxDYWxjdWxhdGVkV2lkdGhPZkNvbHVtbnMoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmdyaWRTZXJ2aWNlLmdyaWRIZWFkZXJFbGVtZW50KSB7XG4gICAgICAgICAgICBjb25zdCB0aExpc3QgPSB0aGlzLmdyaWRTZXJ2aWNlLmdyaWRIZWFkZXJFbGVtZW50Py5xdWVyeVNlbGVjdG9yQWxsKFwidGhcIik7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtjeCwgY29sdW1uXSBvZiBBcnJheS5mcm9tKHRoTGlzdCkuZW50cmllcygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmlkU2VydmljZS5jb2x1bW5zW2N4XS5jYWxjdWxhdGVkV2lkdGggPSBjb2x1bW4ub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHNldFN1YnNjcmlwdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZ3JpZFNlcnZpY2UuY2VsbEVkaXQkXG4gICAgICAgICAgICAucGlwZSh0YWtlVW50aWwodGhpcy4jZGVzdHJveSQpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoZXZlbnQ6IENlbGxFZGl0RXZlbnQpID0+IHRoaXMuY2VsbEVkaXQuZW1pdChldmVudCkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgaGVhZGVyTWFyZ2luKCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHJpZ2h0TWFyZ2luID0gMTI7XG4gICAgICAgIHJldHVybiBgMCAke3JpZ2h0TWFyZ2lufXB4IDAgMGA7XG4gICAgfVxufVxuIiwiPGRpdiBjbGFzcz1cIm1vbmEtZ3JpZFwiPlxuICAgIDxkaXYgY2xhc3M9XCJtb25hLWdyaWQtZ3JvdXAtcGFuZWxcIiBjZGtEcm9wTGlzdCAjZ3JvdXBDb2x1bW5MaXN0PVwiY2RrRHJvcExpc3RcIiBjZGtEcm9wTGlzdE9yaWVudGF0aW9uPVwiaG9yaXpvbnRhbFwiXG4gICAgICAgICAoY2RrRHJvcExpc3REcm9wcGVkKT1cIm9uQ29sdW1uRHJvcEZvckdyb3VwaW5nKCRldmVudClcIiAqbmdJZj1cImdyb3VwYWJsZVwiPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiZ3JpZFNlcnZpY2UuZ3JvdXBDb2x1bW5zLmxlbmd0aCAhPT0gMDsgZWxzZSBub0dyb3VwQ29sdW1uc1RlbXBsYXRlO1wiPlxuICAgICAgICAgICAgPG1vbmEtY2hpcCAqbmdGb3I9XCJsZXQgZ3JvdXBDb2x1bW4gb2YgZ3JpZFNlcnZpY2UuZ3JvdXBDb2x1bW5zXCIgW3JlbW92YWJsZV09XCJ0cnVlXCIgKHJlbW92ZSk9XCJvbkdyb3VwaW5nQ29sdW1uUmVtb3ZlKCRldmVudCwgZ3JvdXBDb2x1bW4pXCI+XG4gICAgICAgICAgICAgICAgPHNwYW4+e3tncm91cENvbHVtbi50aXRsZX19PC9zcGFuPlxuICAgICAgICAgICAgPC9tb25hLWNoaXA+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICA8bmctdGVtcGxhdGUgI25vR3JvdXBDb2x1bW5zVGVtcGxhdGU+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1vbmEtZ3JpZC1ncm91cC1wYW5lbC1wbGFjZWhvbGRlclwiICpuZ0lmPVwiZ3JvdXBQYW5lbFBsYWNlaG9sZGVyVmlzaWJsZVwiPkRyYWcgYSBjb2x1bW4gaGVhZGVyIGhlcmUgdG8gZ3JvdXA8L3NwYW4+XG4gICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgPC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cIm1vbmEtZ3JpZC1oZWFkZXJcIiBbbmdTdHlsZV09XCJ7J21hcmdpbic6IGhlYWRlck1hcmdpbn1cIiAjZ3JpZEhlYWRlckVsZW1lbnQ+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJtb25hLWdyaWQtaGVhZGVyLXdyYXBcIj5cbiAgICAgICAgICAgIDx0YWJsZT5cbiAgICAgICAgICAgICAgICA8Y29sZ3JvdXA+XG4gICAgICAgICAgICAgICAgICAgIDxjb2wgKm5nRm9yPVwibGV0IF8gb2YgZ3JpZFNlcnZpY2UuZ3JvdXBDb2x1bW5zXCIgc3R5bGU9XCJ3aWR0aDogMzRweDtcIj5cbiAgICAgICAgICAgICAgICAgICAgPGNvbCAqbmdGb3I9XCJsZXQgY29sdW1uIG9mIGdyaWRTZXJ2aWNlLmNvbHVtbnNcIiBbc3R5bGUud2lkdGgucHhdPVwiY29sdW1uLmNhbGN1bGF0ZWRXaWR0aFwiIFtzdHlsZS5taW4td2lkdGgucHhdPVwiY29sdW1uLm1pbldpZHRoXCI+XG4gICAgICAgICAgICAgICAgPC9jb2xncm91cD5cbiAgICAgICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgICAgICAgIDx0ciBjZGtEcm9wTGlzdCBbY2RrRHJvcExpc3RDb25uZWN0ZWRUb109XCJncm91cGFibGUgPyBbZ3JvdXBDb2x1bW5MaXN0IV0gOiBbXVwiIChjZGtEcm9wTGlzdERyb3BwZWQpPVwib25Db2x1bW5Ecm9wKCRldmVudClcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCAqbmdGb3I9XCJsZXQgXyBvZiBncmlkU2VydmljZS5ncm91cENvbHVtbnNcIj48L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoICpuZ0Zvcj1cImxldCBjb2x1bW4gb2YgZ3JpZFNlcnZpY2UuY29sdW1uc1wiIGNka0RyYWcgW2Nka0RyYWdEYXRhXT1cImNvbHVtblwiIFtjZGtEcmFnRGlzYWJsZWRdPVwiIXJlb3JkZXJhYmxlICYmICFncm91cGFibGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChtb3VzZW1vdmUpPVwib25Db2x1bW5Nb3VzZUVudGVyKCRldmVudCwgY29sdW1uKVwiIChjZGtEcmFnRW50ZXJlZCk9XCJvbkNvbHVtbkRyYWdFbnRlcigkZXZlbnQsIGNvbHVtbilcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjZGtEcmFnU3RhcnRlZCk9XCJvbkNvbHVtbkRyYWdTdGFydCgkZXZlbnQpXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vbmEtZ3JpZC1jb2x1bW4td3JhcFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1vbmEtZ3JpZC1jb2x1bW4tdGl0bGVcIiAoY2xpY2spPVwib25Db2x1bW5Tb3J0KGNvbHVtbilcIj57e2NvbHVtbi50aXRsZX19PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9uYS1ncmlkLWNvbHVtbi1hY3Rpb25zXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cImdyaWRTZXJ2aWNlLnNvcnRhYmxlT3B0aW9ucy5zaG93SW5kaWNlcyAmJiBjb2x1bW4uc29ydEluZGV4ICE9IG51bGxcIj57e2NvbHVtbi5zb3J0SW5kZXh9fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxmYS1pY29uIFtpY29uXT1cImFzY2VuZGluZ1NvcnRJY29uXCIgKm5nSWY9XCJjb2x1bW4uc29ydERpcmVjdGlvbj09PSdhc2MnXCI+PC9mYS1pY29uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGZhLWljb24gW2ljb25dPVwiZGVzY2VuZGluZ1NvcnRJY29uXCIgKm5nSWY9XCJjb2x1bW4uc29ydERpcmVjdGlvbj09PSdkZXNjJ1wiPjwvZmEtaWNvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxtb25hLWdyaWQtZmlsdGVyLW1lbnUgW2NvbHVtbl09XCJjb2x1bW5cIiBbdHlwZV09XCJjb2x1bW4uZmlsdGVyVHlwZVwiIChhcHBseSk9XCJvbkNvbHVtbkZpbHRlcihjb2x1bW4sICRldmVudClcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqbmdJZj1cImZpbHRlcmFibGVcIj48L21vbmEtZ3JpZC1maWx0ZXItbWVudT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtb25hLWdyaWQtY29sdW1uLWRyb3AtaGludFwiICpuZ0lmPVwiZHJvcENvbHVtbiA9PT0gY29sdW1uICYmIGRyYWdDb2x1bW4gJiYgcmVvcmRlcmFibGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1N0eWxlXT1cInsncmlnaHQnOiBkcmFnQ29sdW1uLmluZGV4IDwgZHJvcENvbHVtbi5pbmRleCA/ICctMXB4JzogbnVsbCwgJ2xlZnQnOiBkcmFnQ29sdW1uLmluZGV4ID4gZHJvcENvbHVtbi5pbmRleCA/ICctMXB4JzogbnVsbH1cIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBtb25hR3JpZENvbHVtblJlc2l6ZUhhbmRsZXIgW2NvbHVtbl09XCJjb2x1bW5cIiBjbGFzcz1cIm1vbmEtZ3JpZC1jb2x1bW4tcmVzaXplclwiICpuZ0lmPVwicmVzaXphYmxlICYmICFjb2x1bW5EcmFnZ2luZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVzaXplU3RhcnQpPVwicmVzaXppbmc9dHJ1ZTtcIiAocmVzaXplRW5kKT1cInJlc2l6aW5nPWZhbHNlO1wiPjwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBjZGtEcmFnUHJldmlldz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vbmEtZ3JpZC1jb2x1bW4tZHJhZy1wcmV2aWV3XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1vbmEtZ3JpZC1jb2x1bW4tdGl0bGVcIj57e2NvbHVtbi50aXRsZX19PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICA8L3RoZWFkPlxuICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIihncmlkU2VydmljZS5yb3dzfGdyaWRGaWx0ZXI6Z3JpZFNlcnZpY2UuYXBwbGllZEZpbHRlcnM6Z3JpZFNlcnZpY2UuYXBwbGllZFNvcnRzKSBhcyBmaWx0ZXJlZERhdGFcIj5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImZpbHRlcmVkRGF0YXxncmlkUGFnZTpncmlkU2VydmljZS5wYWdlU3RhdGUuc2tpcDpncmlkU2VydmljZS5wYWdlU3RhdGUudGFrZSBhcyB2aWV3RGF0YVwiPlxuICAgICAgICAgICAgPG1vbmEtZ3JpZC1saXN0IFtjb2x1bW5zXT1cImdyaWRTZXJ2aWNlLmNvbHVtbnNcIiBbZGF0YV09XCJ2aWV3RGF0YVwiPjwvbW9uYS1ncmlkLWxpc3Q+XG4gICAgICAgICAgICA8bW9uYS1wYWdlciBbc2tpcF09XCJncmlkU2VydmljZS5wYWdlU3RhdGUuc2tpcFwiIFtwYWdlU2l6ZV09XCJncmlkU2VydmljZS5wYWdlU3RhdGUudGFrZVwiIFt0b3RhbF09XCJmaWx0ZXJlZERhdGEubGVuZ3RoXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtwYWdlSW5wdXRdPVwidHJ1ZVwiIFtwYWdlU2l6ZVZhbHVlc109XCJwYWdlU2l6ZVZhbHVlc1wiIChwYWdlU2l6ZUNoYW5nZSk9XCJvblBhZ2VTaXplQ2hhbmdlKCRldmVudClcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKHBhZ2VDaGFuZ2UpPVwib25QYWdlQ2hhbmdlKCRldmVudClcIj48L21vbmEtcGFnZXI+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgIDwvbmctY29udGFpbmVyPlxuPC9kaXY+XG4iXX0=